{% trans_default_domain 'Timetable' %}

{% set h3Content = returnButton({'windowOpen': {'route': path('timetable_manage')}}) %}
{% set h3Content = h3Content ~ resetButton({'javascript': {'function': 'resetBuilder'}, 'additional': 'id="resetButton" reset="All"', mergeClass: 'btn-sm'}) %}
{% include 'Page/panelStart.html.twig' with {'header': 'timetable.period.list.title', 'transDomain': 'Timetable', 'panelParagraph': 'timetable.period.list.description', 'bodyAttr': 'id=tt_periods', 'panelAttr': 'id=tt_periods_panel', headerClass: 'hideSearch'} %}
    <div id="allPeriodMessages"></div>
    {% for period in report.periods %}
        <div class="row-border row row-hover row-striped fixPeriod" id="periodRow{{ period.id }}">
            <div class="col-12 dropPeriod{{ period.status.disableDrop }}" id="period{{ period.id }}">
                <div>
                    {{ miscButton({'additional': 'id="button' ~ period.id ~ '" ' ~ period.status.disableDrop, 'class': 'lockButton fas fa-unlock btn btn-sm btn-' ~ period.status.alert, 'javascript': {'function': 'fixPeriod', 'options': [period.id]}, 'title': 'period.status.messages'|transchoice(period.status.messages|length), transDomain: 'Timetable'})|raw }}
                    {{ resetButton({'javascript': {'function': 'resetBuilder'}, 'additional': 'id="resetButton" reset="All"', 'class': 'fas fa-sync btn btn-sm btn-warning'})|raw }}
                    {{ period.period.columnName }}
                </div>
                <div id="periodStatus{{ period.id }}" class="startHidden container-fluid" style="clear: both;">
                    {% for activity in period.activities %}
                        <div class="row row-hover" id="periodActivity{{ activity.id }}">
                            <div class="col-4 small">
                                {{ activity.fullName }}
                            </div>
                            <div class="col-4 small{{ activity.status.class }}">
                                {% include 'Timetable/Period/activityDetails.html.twig' with {id: period.id, details: activity.details, status: activity.status } %}
                            </div>
                            <div class="col-4">
                                <div>
                                    {{ editButton({mergeClass: 'btn-sm', windowOpen: {route: path('period_activity_edit',
                                        {activity: activity.id, closeWindow: '_closeWindow', activityType: 'Class'}), target: 'PeriodActivity', params: 'width=500,height=600'},
                                        title: 'period.activities.activity.overwrite.button', transDomain: 'Timetable'})|raw }}
                                    {{ miscButton({'class': 'fas fa-cog btn btn-sm btn-success', windowOpen: {route: path('activity_edit', {id:
                                        activity.activity.activity.id, closeWindow: '_closeWindow', activityType: 'Class'}), target: 'Activity',
                                        params: 'width=1200,height=800'}, title: 'period.activities.activity.edit.button', transDomain: 'Timetable'})|raw }}
                                    {{ deleteButton({mergeClass: 'removeActivity btn-sm', colour: 'warning', additional: {id: 'removeActivity' ~ activity.id, period: period.id}, title: 'period.activities.activity.remove.button', transDomain: 'Timetable'})|raw }}
                                </div>
                            </div>

                        </div>
                    {% endfor %}
                    <div id="periodMessage{{ period.id }}">{% if period.id == app.request.get('all') %}
                        {% include 'Default/messages.html.twig' with {messages: periodManager.messageManager} %}{% endif %}
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}
{% include 'Page/panelEnd.html.twig' %}
